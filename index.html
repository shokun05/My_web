<!DOCTYPE html>
<html>
<head>
  <title>My Web + Google Sheet</title>
</head>
<body>
  <h1>üì§ ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h1>
  <form id="my-form">
    <input type="text" name="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠" required><br>
    <input type="email" name="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" required><br>
    <button type="submit">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  </form>

  <h2>üìÑ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet</h2>
  <ul id="sheet-data"></ul>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwt2MGHJhvZzTjZM7MNPBZo3MxrIo32Wgid4b8fW7B2q829t3gYpZHbQBNe-ISa9BuS/exec'; // ‡πÉ‡∏™‡πà URL ‡∏à‡∏≤‡∏Å Google Apps Script

    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    document.getElementById('my-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const data = {
        name: form.name.value,
        email: form.email.value
      };

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data)
      })
      .then(res => res.json())
      .then(result => {
        alert("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        form.reset();
        loadData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
      });
    });

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet
    function loadData() {
      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          const ul = document.getElementById('sheet-data');
          ul.innerHTML = '';
          data.forEach(row => {
            const li = document.createElement('li');
            li.textContent = `${row.name} - ${row.email}`;
            ul.appendChild(li);
          });
        });
    }

    loadData(); // ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
  </script>
</body>
</html>
